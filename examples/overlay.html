<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>demo</title>
<meta http-equiv="Cache-control" content="no-cache">
<meta http-equiv="Expires" content="-1">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
<meta name="format-detection" content="telephone=no">

<link href="dist/css/main.css" rel="stylesheet">
<link href="css/shCoreDefault.css" rel="stylesheet">
<link href="css/console.css" rel="stylesheet">
<link href="css/common.css" rel="stylesheet">
<style>
</style>
<script>function ckControl(){return false}</script>
</head>
<body ontouchstart="return ckControl()">

<div class="ck-root">
    
<header class="ck-header">
    
<a class="ck-top-title" href="index.html">DEMO & DOCS</a>
<span class="opt ck-top-nav"><a class="btn" href="/"></a></span>
<span class="opt ck-top-action"><button class="btn"></button></span>
<span class="opt ck-top-create"></span>

</header>

<div class="ck-wrapper">
    
    <div class="ck-card" id="ckDefault">

        <div class="ckd-top-create">
            <button class="btn reply" data-iframe-url="formpage.html" data-title="发表"></button>
        </div>

        <div class="ck-banner-unit topbox">
            <h2>Overlay</h2>
            <ul class="mods">
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/mod/moui/modalview.js" target="_blank">moui/modalview</a></li>
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/mod/moui/actionview.js" target="_blank">moui/actionview</a></li>
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/mod/moui/growl.js" target="_blank">moui/growl</a></li>
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/cardkit/view/modalview.js" target="_blank">cardkit/view/modalview</a></li>
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/cardkit/view/actionview.js" target="_blank">cardkit/view/actionview</a></li>
                <li><a href="http://code.dapps.douban.com/cardkit/blob/master/js/cardkit/view/growl.js" target="_blank">cardkit/view/growl</a></li>
            </ul>
        </div>

        <div class="ck-form-unit">
            <header class="ckd-hd">Modal View</header>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-modal-button" 
                    data-url="formcontent.html" 
                    data-title="ajax">Open</button>
                <!--demo end-->
                <label>通过ajax接口加载内容</label>
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-modal-button" 
                        data-url="formcontent.html" 
                        data-title="ajax">Open</button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-modal-button" 
                    data-json-url="data/form.json" 
                    data-title="json">Open</button>
                <!--demo end-->
                <label>通过json接口加载内容</label>
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-modal-button" 
                        data-json-url="data/form.json" 
                        data-title="json">Open</button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-modal-button" 
                    data-iframe-url="formpage.html" 
                    data-title="iframe">Open</button>
                <!--demo end-->
                <label>通过iframe加载内容</label>
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-modal-button" 
                        data-iframe-url="formpage.html" 
                        data-title="iframe">Open</button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-modal-button" 
                    data-source="formBox" 
                    data-title="inline html">Open</button>
                <!--demo end-->
                <label>用隐藏的html作内容</label>
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-modal-button" 
                        data-source="formBox" 
                        data-title="inline html">Open</button>
                    ]]></script>
                </div>
            </div>
        </div>

        <div class="ck-form-unit">
            <header class="ckd-hd">Action View</header>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-actions-button actions1"
                        data-fluid="true"
                        data-title="选择排序方式">
                    <span>Order by default</span>
                    <a href="#price" class="ck-option">Order by price</a>
                    <a href="#date" class="ck-option">Order by date</a>
                    <a href="#alpha" class="ck-option">Order by alphabet</a>
                    <a href="#editor" class="ck-option">Order by editor</a>
                </button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-actions-button actions1"
                            data-fluid="true"
                            data-title="选择排序方式">
                        <span>Order by default</span>
                        <a href="#price" class="ck-option">Order by price</a>
                        <a href="#date" class="ck-option">Order by date</a>
                        <a href="#alpha" class="ck-option">Order by alphabet</a>
                        <a href="#editor" class="ck-option">Order by editor</a>
                    </button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-actions-button actions2"
                        data-fluid="true"
                        data-multiselect="true"
                        data-confirm-text="继续"
                        data-cancel-text="放弃"
                        data-title="Choose members"
                        data-content="1. member A<br>2. member B<br>3. member C<br>4. member D">
                    <span>Choose members</span>
                    <input class="ck-option" type="button" value="A">
                    <input class="ck-option" type="button" value="B">
                    <input class="ck-option" type="button" value="C">
                    <input class="ck-option" type="button" value="D">
                </button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-actions-button actions2"
                            data-fluid="true"
                            data-multiselect="true"
                            data-confirm-text="继续"
                            data-cancel-text="放弃"
                            data-title="Choose members"
                            data-content="1. member A<br>2. member B<br>3. member C<br>4. member D">
                        <span>Choose members</span>
                        <input class="ck-option" type="button" value="A">
                        <input class="ck-option" type="button" value="B">
                        <input class="ck-option" type="button" value="C">
                        <input class="ck-option" type="button" value="D">
                    </button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-actions-button actions3"
                        data-fluid="true">
                    <span>Jump list</span>
                    <a href="picker.html" class="ck-option" target="_self">picker.html</a>
                    <a href="control.html" class="ck-option" target="_self">control.html</a>
                    <a href="index.html" class="ck-option" target="_self">index.html</a>
                    <a href="tel:114" class="ck-option" target="_top">tel:114</a>
                </button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-actions-button actions3"
                            data-fluid="true">
                        <span>Jump list</span>
                        <a href="picker.html" class="ck-option" target="_self">picker.html</a>
                        <a href="control.html" class="ck-option" target="_self">control.html</a>
                        <a href="index.html" class="ck-option" target="_self">index.html</a>
                        <a href="tel:114" class="ck-option" target="_top">tel:114</a>
                    </button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="my-actions-button ckbase-btn"
                        data-fluid="true">
                    <span>Generated Action menu</span>
                </button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="my-actions-button"
                            data-fluid="true">
                        <span>Generated Action menu</span>
                    </button>
                    ]]></script>
                    <script type="syntaxhighlighter" class="brush: js"><![CDATA[
                    $('.my-actions-button').bind('tap', function(){
                        console.info(this)
                        ck.actionView(this, {
                            title: 'This is title',
                            content: 'This is content',
                            options: [
                                '<a href="picker.html" class="ck-option" target="_self">picker.html</a>',
                                '<a href="index.html" class="ck-option" target="_self">index.html</a>',
                                '<a href="tel:114" class="ck-option" target="_top">tel:114</a>',
                                '<a href="#C" class="ck-option">C</a>',
                                '<input class="ck-option" type="button" value="A">',
                                '<input class="ck-option" type="button" value="B">'
                            ].join('')
                        }).open();
                    });
                    $('.my-actions-button').bind('actionView:confirm', when_confirm);
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="my-confirm-button ckbase-btn"
                        data-fluid="true">
                    <span>Confirm/Alert (No Options)</span>
                </button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="my-actions-button" data-fluid="true">
                        <span>Confirm/Alert (No Options)</span>
                    </button>
                    ]]></script>
                    <script type="syntaxhighlighter" class="brush: js"><![CDATA[
                    ck.delegate.on('tap', '.my-confirm-button, .my-confirm-button span', function(){
                        var me = $(this);
                        if (!me.hasClass('my-confirm-button')) {
                            me = me.parent();
                        }
                        ck.actionView(me, {
                            title: 'This is title',
                            content: 'This is content',
                            multiselect: true,
                            confirmText: '确定'
                        }).open();
                    });
                    ck.delegate.on('actionView:confirm', '.my-confirm-button', function(){
                        location.reload(true);
                    });
                    ]]></script>
                </div>
            </div>
        </div>

        <div class="ck-form-unit">
            <header class="ckd-hd">Growl</header>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-growl-button"
                    data-content="测试！">Tips A</button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-growl-button"
                        data-content="测试！">Tips A</button>
                    ]]></script>
                </div>
            </div>
            <div class="ckd-item">
                <!--demo-->
                <button class="ck-growl-button"
                    data-expires="1000"
                    data-corner="bottom"
                    data-content="测试！">Tips B</button>
                <!--demo end-->
                <div class="democode">
                    <script type="syntaxhighlighter" class="brush: html"><![CDATA[
                    <button class="ck-growl-button"
                        data-expires="1000"
                        data-corner="bottom"
                        data-content="测试！">Tips B</button>
                    ]]></script>
                </div>
            </div>
        </div>

        <div class="ck-box-unit">
            <header class="ckd-hd">Console</header>
            <div class="ckd-content" id="console">
            </div>
        </div>

    </div>

    <div class="ck-card ck-loading" id="ckLoading">
        <div>
            <p><span></span><span></span><span></span></p>
            <p>加载中...</p>
        </div>
    </div>

    <footer class="ck-footer">
        <div class="copyright">&copy; 2005－2012 douban.com, all rights reserved</div>
    </footer>

</div>

<div class="ck-raw">

<script type="text/template" class="formBox">
<form action="data/post_result.json" id="inlineForm1">
<div class="ck-form-unit">
    <div class="ckd-item">
        <label class="ck-title">章节名</label>
        <input type="text" value="" name="a" placeholder="章节名">
    </div>
    <div class="ckd-item">
        <label class="ck-title">笔记内容</label>
        <textarea name="b" placeholder="笔记内容"></textarea>
        <label><em>注释</em></label>
    </div>
</div>
</form>
</script>

<script type="text/jscode" class="formBox">
console.info('execute js for formBox');
require([
    'dollar', 
    'mo/network', 
    'cardkit/app'
], function($, net, ck){
    ck.modalCard.event.bind('confirmOnThis', function(modal){
        var form = $('#inlineForm1');
        modal.showLoading();
        net.ajax({
            url: form.attr('action'),
            type: 'post',
            data: new FormData(form[0]),
            processData: false,
            contentType: false,
            success: function(maybe_json){
                modal.hideLoading();
                var json = net.parseJSON(maybe_json) || { e: 0 };
                if (!json.e) {

                    location.href = 'redirect.html';

                    /**
                     * other usecase:
                     */

                    //location.href = 'http://www.douban.com/photos/album/46548339/';

                    //ck.openURL('picker.html');

                    //location.reload();

                    //modal.ok().then(function(){
                        //location.reload();
                    //});

                } else {
                    ck.growl({
                        expires: 3000,
                        content: '提交出错！',
                        corner: 'bottom'
                    }).open();
                }
            }
        });
    });
});
</script>

</div>

</div>

<script src="dist/js/main.js"></script>
<script src="js/shCore.js"></script>
<script src="js/shBrushXml.js"></script>
<script src="js/shBrushJScript.js"></script>
<!-- COLLECTED JS -->
<script>
require([
    'dollar',
    'cardkit/app',
    'cardkit/pageready'
], function($, ck){

    var notify = ck.growl({
        corner: 'bottom'
    });

    $('.my-actions-button').bind('actionView:confirm', when_confirm);

    $('.my-actions-button').bind('tap', function(){
        ck.actionView(this, {
            title: 'This is title',
            content: 'This is content',
            options: [
                '<a href="picker.html" class="ck-option" target="_self">picker.html</a>',
                '<a href="index.html" class="ck-option" target="_self">index.html</a>',
                '<a href="tel:114" class="ck-option" target="_top">tel:114</a>',
                '<a href="#C" class="ck-option">C</a>',
                '<input class="ck-option" type="button" value="A">',
                '<input class="ck-option" type="button" value="B">'
            ].join('')
        }).open();
    });

    ck.delegate.on('actionView:confirm', {

        '.actions1': when_confirm,

        '.actions2': when_confirm,

        '.my-confirm-button': function(){
            location.reload(true);
        }
    
    }).on('tap', {

        '.my-confirm-button, .my-confirm-button span': function(){
            var me = $(this);
            if (!me.hasClass('my-confirm-button')) {
                me = me.parent();
            }
            ck.actionView(me, {
                title: 'This is title',
                content: 'This is content',
                multiselect: true,
                confirmText: '确定'
            }).open();
        }
    
    });

    function when_confirm(e){
        var result = e.component.val();
        console.info('value: ', result);
        notify.set({
            content: 'value: ' + result
        }).open();
    }

});

SyntaxHighlighter.defaults['toolbar'] = false;
SyntaxHighlighter.all();
define('cardkit/env', [], function(){
    return {
        enableConsole: true
    };
});
</script>
<script>
</script>
<!-- vagrant-->
</body>
</html>
